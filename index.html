<html>
    <head>
        <meta charset="utf-8">
        <title>Abstractn/rand/</title>
        
        <link rel="stylesheet" type="text/css" href="https://abstractn.github.io/repo/abs.css">
        <script src="https://kit.fontawesome.com/e97eac13ba.js" crossorigin="anonymous"></script>

        <style>
            #content
            {
                width:300px;
            }
            
            #index
            {
                list-style-type:none;
            }

            .index-elem
            {
                display:block;
                margin:5px 0;
            }

            #index span, #index span a
            {
                width:max-content;
            }

            .index-elem a
            {
                position:relative;
                padding: 0 5px;
                width:max-content;
                color:var(--main-color-b3);
                background-color:var(--main-color-w);
                text-decoration:none;
                border-radius:2px;
                transition-duration:.2s;
                animation-direction: alternate;
                left:0px;
            }
            
            .index-elem a:hover
            {
                color:var(--main-color-w);
                background-color:var(--noixe-color-ar);
                left:5px;
            }

            .index-elem i
            {
                width:20px;
            }
        </style>
    </head>
    
    <body>
        <div id="title" class="flex spaced center">index of: abstractn/rand/</div>
        <div id="content">
            <div id="index">
            </div>
        </div>
        
        <script>
            const DONE = 4;
            const OK = 200; // status 200 is a successful return.

            window.onload = init;
            
            function init()
            {
                loadIndex();
            }
            /*
            function loadIndex()
            {
                console.log("loadIndex()");
                var files = ajax('GET','https://api.github.com/repos/Abstractn/rand/contents/');
                console.log("requested call");
                while(files == undefined)
                {
                    console.log("waiting");
                    if(files == false)
                    {
                        console.warn("ajax call failed");
                    }
                    else
                    // if(files != false && files != undefined)
                    {
                        console.log("recieved");
                        let list = document.getElementById("index");
                        let res = "";
                        for(let i=0; i<files.length; i++)
                        {
                            res = res + '<li> <a href="'+files[i].name+'">'+files[i].name+'</a> </li>';
                        }
                        list.innerHTML = res;
                    }
                }
            }
            
            function ajax(method,url)
            {
                console.log("ajax()");
                console.log("url="+url);
                let xhr = new XMLHttpRequest();
                xhr.open(method, url);
                xhr.send(null);

                xhr.onreadystatechange = function ()
                {
                    if (xhr.readyState === xhr.DONE)
                    {
                        console.log("call DONE");
                        if (xhr.status === OK)
                        {
                            console.log("call OK");
                            // console.warn( JSON.parse(xhr.responseText) );
                            return JSON.parse(xhr.responseText);
                        }
                        else
                        {
                            console.error('Ajax error: ' + xhr.status);
                            return false;
                        }
                    }
                };
            }
            */
            function loadIndex()
            {
                // console.log('ajax call started');
                let xhr = new XMLHttpRequest();
                xhr.open('GET', 'https://api.github.com/repos/Abstractn/rand/contents/');
                xhr.send(null);

                xhr.onreadystatechange = function ()
                {
                    if (xhr.readyState === DONE)
                    {
                        if (xhr.status === OK)
                        {
                            var ignoredFiles=[
                                "README.md",
                                "_config.yml",
                                "index.html"
                            ];
                            var f_ignore=false;
                            var res="";
                            var type="";
                            var icon="";
                            //convertJsonToLi(ulMenu, xhr.responseText);
                            const files = JSON.parse(xhr.responseText);
                            for (let i = 0; i < files.length; i++)
                            {
                                // console.log( files[i].name );
                                for(let j=0; j<ignoredFiles.length; j++)
                                {
                                    // console.log(files[i].name+" <> "+ignoredFiles[j]);
                                    if(files[i].name == ignoredFiles[j])
                                    { f_ignore=true; console.warn("ignoring: "+ignoredFiles[j]); break; }
                                }
                                if(!f_ignore)
                                {
                                    switch(files[i].type)
                                    {
                                        case "file": icon='<i class="fas fa-file"></i>'; break;
                                        case "dir": icon='<i class="fas fa-folder"></i>'; break;
                                        default: null;

                                    }
                                    res = res + '<span class="index-elem"> <a class="'+files[i].type+'" href="'+files[i].name+'">'+icon+' '+files[i].name+'</a> </span>';
                                    f_ignore=false;
                                }
                                f_ignore=false;
                            }
                            document.getElementById("index").innerHTML = res;
                        }
                        else
                        {
                            console.error('Ajax error: ' + xhr.status);
                        }
                    }
                };
            }
        </script>
    </body>
</html>

<!--
    https://api.github.com/repos/Abstractn/rand/contents/

    --------------

    /* var files = [
        "3d",
        "animeJs",
        "animeJSdemo",
        "animeJSdemo2",
        "animeJSdemo3",
        "animeJSdemo4",
        "varlet",
        "draw",
        "fakeLog",
        "fractal",
        "fTyper",
        "glasses",
        "grid_telegram",
        "gridgame",
        "libtest",
        "parallax",
        "phone",
        "phone2",
        "phone3-2",
        "phone3",
        "phoneBoot",
        "police-shadow",
        "police-shadow2",
        "police-shadow3",
        "police-stroke",
        "rotor"
    ];
    for(i=0; i<files.length; i++)
    { document.write('<li> <a href="'+files[i]+'.html">'+files[i]+'</a> </li>'); } */
-->
